import{s as l,c as d,l as u,m as g,a as v,b as y}from"./vendor.62b5dbce.js";const b=function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))s(t);new MutationObserver(t=>{for(const r of t)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function i(t){const r={};return t.integrity&&(r.integrity=t.integrity),t.referrerpolicy&&(r.referrerPolicy=t.referrerpolicy),t.crossorigin==="use-credentials"?r.credentials="include":t.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(t){if(t.ep)return;t.ep=!0;const r=i(t);fetch(t.href,r)}};b();const x=l("svg"),f=100;class w{constructor(a,i,s,t,r,o,c,n){this.ip_str=a,this.isp=i,this.org=s,this.os=t,this.port=r,this.timestamp=o,this.location=c,this.vulns=n}}class L{constructor(a,i,s,t){this.cve=a,this.count=i,this.verified=s,this.cvss=t}}await d("data/shodan.csv",e=>new w(e.ip_str,e.isp,e.org,e.os,+e.port,new Date(e.timestamp),+e.location,JSON.parse(e.vulns)));const p=await d("data/vulnerabilities.csv",e=>new L(e.cve,parseInt(e.count),e.verified=="true",parseFloat(e.cvss)));function m(e=!1){l("g").remove();const a=document.getElementById("left-plot").getBoundingClientRect(),i=a.width-f,s=a.height-f,t=x.append("g").attr("transform","translate(90, 25)"),r=u().domain([0,10]).range([0,i]),o=u().domain([0,g(p,n=>n.count)]).range([s,0]);t.append("g").attr("transform","translate(0,"+s+")").call(v(r)),t.append("text").attr("class","label").attr("text-anchor","end").attr("x",i).attr("y",s+50).text("Severity (CVSS score)"),t.append("g").call(y(o).ticks(10)),t.append("text").attr("class","label").attr("text-anchor","end").attr("transform","rotate(-90)").attr("y",-50).attr("x",0).text("Number of affected devices");const c=t.append("g").selectAll("dot").data(p).enter().append("circle").attr("r",3).attr("cx",n=>r(n.cvss)).attr("cy",n=>o(n.count)).style("fill","#EA5F21ff");e&&c.style("fill","#EA5F2100").attr("cy",n=>s).transition().delay((n,h)=>3*h+Math.random()*700).duration(500+Math.random()*2e3).attr("cy",n=>o(n.count)).style("fill","#EA5F21ff")}window.addEventListener("resize",()=>m());m(!0);
