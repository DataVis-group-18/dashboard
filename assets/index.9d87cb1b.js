import{s as u,l as m,c as b,a as w,b as k,d as M}from"./vendor.2867bd82.js";const L=function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))i(e);new MutationObserver(e=>{for(const a of e)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function n(e){const a={};return e.integrity&&(a.integrity=e.integrity),e.referrerpolicy&&(a.referrerPolicy=e.referrerpolicy),e.crossorigin==="use-credentials"?a.credentials="include":e.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(e){if(e.ep)return;e.ep=!0;const a=n(e);fetch(e.href,a)}};L();const d=u("svg"),g=200,p=parseInt(d.attr("width"))-g,f=parseInt(d.attr("height"))-g,l=m().range([0,p]),c=m().range([f,0]),h=d.append("g").attr("transform","translate(100, 50)");class O{constructor(r,n,i,e,a,o,v,x){this.ip_str=r,this.isp=n,this.org=i,this.os=e,this.port=a,this.timestamp=o,this.location=v,this.vulns=x}}const y=await b("data/shodan.csv",t=>new O(t.ip_str,t.isp,t.org,t.os,+t.port,new Date(t.timestamp),+t.location,JSON.parse(t.vulns)));console.log(y);let s=new Map;for(const t of y){if(!t.vulns)continue;let r=Object.keys(t.vulns).length,n=s.get(r)||0;s.set(r,n+1)}Math.min(...s.values());Math.max(...s.values());l.domain([Math.min(...s.keys()),Math.max(...s.keys())]);c.domain([Math.min(...s.values()),Math.max(...s.values())]);console.log(s);h.append("g").attr("transform","translate(0,"+f+")").call(w(l)).append("text").attr("y",50).attr("x",p).attr("text-anchor","end").attr("stroke","black").text("x label");h.append("g").call(k(c).ticks(10)).append("text").attr("transform","rotate(-90)").attr("y",6).attr("dy","-5.1em").attr("text-anchor","end").attr("stroke","black").text("y label");h.selectAll(".bar").data(s.entries()).enter().append("rect").on("mouseover",function(){u(this).transition().delay(.5).style("fill","orange")}).on("mouseout",function(){u(this).transition().delay(.5).style("fill","black")}).attr("class","bar").attr("x",t=>l(t[0])).attr("y",t=>c(t[1])).attr("width",p/l.range()[1]).transition().ease(M).duration(400).delay((t,r)=>r*50).attr("height",t=>f-c(t[1]));
