import{s as x,c as d,l as u,m as b,a as w,b as L}from"./vendor.62b5dbce.js";const N=function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))a(e);new MutationObserver(e=>{for(const r of e)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&a(o)}).observe(document,{childList:!0,subtree:!0});function n(e){const r={};return e.integrity&&(r.integrity=e.integrity),e.referrerpolicy&&(r.referrerPolicy=e.referrerpolicy),e.crossorigin==="use-credentials"?r.credentials="include":e.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function a(e){if(e.ep)return;e.ep=!0;const r=n(e);fetch(e.href,r)}};N();const l=x("svg"),p=200,f=parseInt(l.attr("width"))-p,c=parseInt(l.attr("height"))-p,i=l.append("g").attr("transform","translate(100, 50)");class O{constructor(s,n,a,e,r,o,g,y){this.ip_str=s,this.isp=n,this.org=a,this.os=e,this.port=r,this.timestamp=o,this.location=g,this.vulns=y}}class S{constructor(s,n,a,e){this.cve=s,this.count=n,this.verified=a,this.cvss=e}}await d("data/shodan.csv",t=>new O(t.ip_str,t.isp,t.org,t.os,+t.port,new Date(t.timestamp),+t.location,JSON.parse(t.vulns)));const h=await d("data/vulnerabilities.csv",t=>new S(t.cve,parseInt(t.count),t.verified=="true",parseFloat(t.cvss))),m=u().domain([0,10]).range([0,f]),v=u().domain([0,b(h,t=>t.count)]).range([c,0]);i.append("g").attr("transform","translate(0,"+c+")").call(w(m));i.append("text").attr("class","label").attr("text-anchor","end").attr("x",f).attr("y",c+50).text("Severity (CVSS score)");i.append("g").call(L(v).ticks(10));i.append("text").attr("class","label").attr("text-anchor","end").attr("transform","rotate(-90)").attr("y",-50).attr("x",0).text("Number of affected devices");i.append("g").selectAll("dot").data(h).enter().append("circle").attr("r",3).attr("cx",t=>m(t.cvss)).attr("cy",c).style("fill","#EA5F2100").transition().delay((t,s)=>3*s+Math.random()*700).duration(500+Math.random()*2e3).attr("cy",t=>v(t.count)).style("fill","#EA5F21ff");
